#!/usr/bin/env node

const { Command } = require('commander');

const packageJson = require('../package.json');

function increaseVerbosity(_, previous) {
  return previous + 1;
}

const program = new Command();
program
.version(packageJson.version)
.option('-f, --force', 'force to generate output json files')
.option('-v, --verbose', 'verbosity that can be increased', increaseVerbosity, 0)
.parse(process.argv);

new Promise(async (resolve, reject) => {
  // do a thing, possibly async, thenâ€¦
  const theApp = require('../lib');
  console.log('verbose', program.verbose);
  const retCode =  await theApp.run();
  if (0 === retCode) {
    console.log('inquirer succeed!');
    resolve(0);
  }  
  else {
    reject(new Error(`${retCode}`));
  }
})
.catch( error => {
  console.log(`inquirer quit: `, error.message);
})
